"use strict";var wrap=document.querySelector(".wrap"),calc=wrap.querySelector(".calc"),bin=calc.querySelector(".bin"),dec=calc.querySelector(".dec"),hex=calc.querySelector(".hex"),keysWrap=wrap.querySelector(".keys"),keys=keysWrap.querySelectorAll(".key"),inputIncrement=function(){dec.value++,bin.value=parseInt(dec.value,10).toString(2),hex.value=parseInt(dec.value,10).toString(16)},inputDecrement=function(){dec.value--,dec.value<=0?bin.value=dec.value=hex.value="":(bin.value=parseInt(dec.value,10).toString(2),hex.value=parseInt(dec.value,10).toString(16))},updateFields=function(e){""==e.value?bin.value=dec.value=hex.value="":0==e.value?bin.value=dec.value=hex.value=0:e==bin?(dec.value=parseInt(bin.value,2).toString(10),hex.value=parseInt(bin.value,2).toString(16)):e==dec?(bin.value=parseInt(dec.value,10).toString(2),hex.value=parseInt(dec.value,10).toString(16)):e==hex&&(bin.value=parseInt(hex.value,16).toString(2),dec.value=parseInt(hex.value,16).toString(10))},getStringChunks=function(e){var t=e.selectionStart,n=e.selectionEnd,i=e.value.split(""),l=i.splice(0,t),c=i.splice(0,n-t),o=i.splice(0);return{left:l.join(""),selection:c.join(""),right:o.join("")}},inputSymbol=function(e,t,n){e.value=t.left+n+t.right,e.selectionStart=e.selectionEnd=t.left.length+1,updateFields(e)};if(touch){window.onorientationchange=function(){return document.activeElement.focus()};var inputBackspace=function(e,t){t.selection||(t.left=t.left.slice(0,-1)),e.value=t.left+t.right,e.selectionStart=e.selectionEnd=t.left.length,updateFields(e)},inputDelete=function(e,t){t.selection||(t.right=t.right.slice(1)),e.value=t.left+t.right,e.selectionStart=e.selectionEnd=t.left.length,updateFields(e)},inputLeft=function(e,t){t.left.length>0?(e.value=t.left+t.selection+t.right,t.selection?e.selectionStart=e.selectionEnd=t.left.length:e.selectionStart=e.selectionEnd=t.left.length-1):t.selection&&(e.selectionStart=e.selectionEnd=0)},inputRight=function(e,t){t.right.length>0?(e.value=t.left+t.selection+t.right,t.selection?e.selectionStart=e.selectionEnd=t.left.length+t.selection.length:e.selectionStart=e.selectionEnd=t.left.length+1):t.selection&&(e.selectionStart=e.selectionEnd=t.left.length+t.selection.length+t.right.length)};document.addEventListener("mousedown",function(e){e.stopPropagation();var t=e.target;t.classList.contains("input")||e.preventDefault();var n=document.activeElement,i=getStringChunks(n);t.classList.contains("key")?inputSymbol(n,i,t.textContent):t.classList.contains("ctl-backspace")?inputBackspace(n,i):t.classList.contains("ctl-del")?inputDelete(n,i):t.classList.contains("ctl-left")?inputLeft(n,i):t.classList.contains("ctl-right")?inputRight(n,i):t.classList.contains("ctl-decrement")?inputDecrement(n):t.classList.contains("ctl-increment")&&inputIncrement(n)}),calc.addEventListener("click",function(e){var t=e.target;if(t==bin)for(var n=0,i=keys.length;n<i;n++)keys[n].classList.contains("key-bin")?keys[n].disabled=!1:keys[n].disabled=!0;else if(t==dec)for(var l=0,c=keys.length;l<c;l++)keys[l].classList.contains("key-hex")?keys[l].disabled=!0:keys[l].disabled=!1;else if(t==hex)for(var o=0,a=keys.length;o<a;o++)keys[o].disabled=!1})}else{var binInclude=["0","1"],decInclude=["0","1","2","3","4","5","6","7","8","9"],allowLetters=["KeyA","KeyB","KeyC","KeyD","KeyE","KeyF"],allowKeys=["Tab","ShiftLeft","ShiftRight","ControlLeft","ControlRight","ArrowLeft","ArrowRight","End","Home","Delete","Backspace"],contains=function(e,t){for(var n=e.length,i=0;i<n;i++)if(e[i]===t)return!0;return!1};bin.onkeydown=function(e){return!(!contains(binInclude,e.key)&&!contains(allowKeys,e.code))||("ArrowUp"==e.code?inputIncrement():"ArrowDown"==e.code&&inputDecrement(),!1)},bin.onkeyup=function(){updateFields(bin)},dec.onkeydown=function(e){return!(!contains(decInclude,e.key)&&!contains(allowKeys,e.code))||("ArrowUp"==e.code?inputIncrement():"ArrowDown"==e.code&&inputDecrement(),!1)},dec.onkeyup=function(){updateFields(dec)},hex.onkeydown=function(e){if(contains(decInclude,e.key)||contains(allowKeys,e.code))return!0;if(contains(allowLetters,e.code)){var t=getStringChunks(hex);inputSymbol(hex,t,e.code.toString().slice(-1))}else"ArrowUp"==e.code?inputIncrement():"ArrowDown"==e.code&&inputDecrement();return!1},hex.onkeyup=function(){updateFields(hex)},document.querySelector(".top").onclick=function(e){e.stopPropagation(),inputIncrement()},document.querySelector(".bottom").onclick=function(e){e.stopPropagation(),inputDecrement()}}