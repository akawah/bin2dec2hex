let wrap=document.querySelector(".wrap"),calc=wrap.querySelector(".calc"),bin=calc.querySelector(".bin"),dec=calc.querySelector(".dec"),hex=calc.querySelector(".hex"),keysWrap=wrap.querySelector(".keys"),keys=keysWrap.querySelectorAll(".key"),inputIncrement=()=>{dec.value++,bin.value=parseInt(dec.value,10).toString(2),hex.value=parseInt(dec.value,10).toString(16)},inputDecrement=()=>{dec.value--,dec.value<=0?bin.value=dec.value=hex.value="":(bin.value=parseInt(dec.value,10).toString(2),hex.value=parseInt(dec.value,10).toString(16))},updateFields=e=>{""==e.value?bin.value=dec.value=hex.value="":0==e.value?bin.value=dec.value=hex.value=0:e==bin?(dec.value=parseInt(bin.value,2).toString(10),hex.value=parseInt(bin.value,2).toString(16)):e==dec?(bin.value=parseInt(dec.value,10).toString(2),hex.value=parseInt(dec.value,10).toString(16)):e==hex&&(bin.value=parseInt(hex.value,16).toString(2),dec.value=parseInt(hex.value,16).toString(10))},getStringChunks=e=>{let t=e.selectionStart,n=e.selectionEnd,l=e.value.split(""),i=l.splice(0,t),c=l.splice(0,n-t),o=l.splice(0);return{left:i.join(""),selection:c.join(""),right:o.join("")}},inputSymbol=(e,t,n)=>{e.value=t.left+n+t.right,e.selectionStart=e.selectionEnd=t.left.length+1,updateFields(e)};if(touch){window.onorientationchange=(()=>document.activeElement.focus());let e=(e,t)=>{t.selection||(t.left=t.left.slice(0,-1)),e.value=t.left+t.right,e.selectionStart=e.selectionEnd=t.left.length,updateFields(e)},t=(e,t)=>{t.selection||(t.right=t.right.slice(1)),e.value=t.left+t.right,e.selectionStart=e.selectionEnd=t.left.length,updateFields(e)},n=(e,t)=>{t.left.length>0?(e.value=t.left+t.selection+t.right,t.selection?e.selectionStart=e.selectionEnd=t.left.length:e.selectionStart=e.selectionEnd=t.left.length-1):t.selection&&(e.selectionStart=e.selectionEnd=0)},l=(e,t)=>{t.right.length>0?(e.value=t.left+t.selection+t.right,t.selection?e.selectionStart=e.selectionEnd=t.left.length+t.selection.length:e.selectionStart=e.selectionEnd=t.left.length+1):t.selection&&(e.selectionStart=e.selectionEnd=t.left.length+t.selection.length+t.right.length)};document.addEventListener("mousedown",i=>{i.stopPropagation();let c=i.target;c.classList.contains("input")||i.preventDefault();let o=document.activeElement,s=getStringChunks(o);c.classList.contains("key")?inputSymbol(o,s,c.textContent):c.classList.contains("ctl-backspace")?e(o,s):c.classList.contains("ctl-del")?t(o,s):c.classList.contains("ctl-left")?n(o,s):c.classList.contains("ctl-right")?l(o,s):c.classList.contains("ctl-decrement")?inputDecrement(o):c.classList.contains("ctl-increment")&&inputIncrement(o)}),calc.addEventListener("click",e=>{let t=e.target;if(t==bin)for(let e=0,t=keys.length;e<t;e++)keys[e].classList.contains("key-bin")?keys[e].disabled=!1:keys[e].disabled=!0;else if(t==dec)for(let e=0,t=keys.length;e<t;e++)keys[e].classList.contains("key-hex")?keys[e].disabled=!0:keys[e].disabled=!1;else if(t==hex)for(let e=0,t=keys.length;e<t;e++)keys[e].disabled=!1})}else{let e=["0","1"],t=["0","1","2","3","4","5","6","7","8","9"],n=["KeyA","KeyB","KeyC","KeyD","KeyE","KeyF"],l=["Tab","ShiftLeft","ShiftRight","ControlLeft","ControlRight","ArrowLeft","ArrowRight","End","Home","Delete","Backspace"],i=(e,t)=>{let n=e.length;for(var l=0;l<n;l++)if(e[l]===t)return!0;return!1};bin.onkeydown=(t=>!(!i(e,t.key)&&!i(l,t.code))||("ArrowUp"==t.code?inputIncrement():"ArrowDown"==t.code&&inputDecrement(),!1)),bin.onkeyup=(()=>{updateFields(bin)}),dec.onkeydown=(e=>!(!i(t,e.key)&&!i(l,e.code))||("ArrowUp"==e.code?inputIncrement():"ArrowDown"==e.code&&inputDecrement(),!1)),dec.onkeyup=(()=>{updateFields(dec)}),hex.onkeydown=(e=>{if(i(t,e.key)||i(l,e.code))return!0;if(i(n,e.code)){let t=getStringChunks(hex);inputSymbol(hex,t,e.code.toString().slice(-1))}else"ArrowUp"==e.code?inputIncrement():"ArrowDown"==e.code&&inputDecrement();return!1}),hex.onkeyup=(()=>{updateFields(hex)}),document.querySelector(".top").onclick=(e=>{e.stopPropagation(),inputIncrement()}),document.querySelector(".bottom").onclick=(e=>{e.stopPropagation(),inputDecrement()})}